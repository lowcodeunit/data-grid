
<div fxLayoutAlign=" start">
  <mat-form-field *ngIf="Config?.Features?.Filter" class="filter-field">
    <input matInput type="text" (keyup)="ApplyFilter($event.target.value)" placeholder="Filter">
  </mat-form-field>
</div>
<mat-progress-bar mode="indeterminate" *ngIf="ShowLoader"></mat-progress-bar>
<mat-table [dataSource]="dataSource" matSort *ngIf="Config" (matSortChange)="Sorting($event)">
  <ng-container *ngFor="let column of Config.ColumnDefs" matColumnDef="{{ column.ColType }}">
    <mat-header-cell *matHeaderCellDef mat-sort-header [disabled]="!column.Sortable" fxLayoutAlign="center center">

      <!--
        Show select checkbox in the header
      -->
      <mat-checkbox *ngIf="ToggleSelection(Config, column)"
                    (change)="$event ? MasterToggle() : null"
                    [checked]="selection.hasValue() && IsAllSelected()"
                    [indeterminate]="selection.hasValue() && !IsAllSelected()">
      </mat-checkbox>

      <!--
        Show the header title
      -->
      {{ column.Title }}

    </mat-header-cell>

    <mat-cell *matCellDef="let item" fxLayoutAlign="center center">

      <!--
        Show select checkbox in the row
      -->
      <mat-checkbox *ngIf="ToggleSelection(Config, column)"
                    (click)="$event.stopPropagation()"
                    (change)="$event ? selection.toggle(item) : null"
                    [checked]="selection.isSelected(item)">
      </mat-checkbox>

      <span *ngIf="column.ColType !== 'select'" fxLayoutAlign="center center">

        <!--Toggle icons on and off-->
        <i *ngIf="column.ShowIcon" class="dg-icons" [ngClass]="column.SetIcon(item)"></i>
        <!-- <mat-icon *ngIf="column.ShowIcon" class="dg-icons" [ngClass]="column.SetIcon(item)">{{column.SetIcon(item)}}</mat-icon> -->

        <!--When adding a button to the table cell-->
          <button *ngIf="column.Action && column.Action.ActionType === 'button'"  
            mat-button (click)="column.Action.ActionHandler(column)">
            <mat-icon>{{column.SetIcon(item)}}</mat-icon>
          </button>

          <!--When adding an href-->
          <a *ngIf="column.Action && column.Action.ActionType === 'href'"  
            style="text-decoration:none;" href="{{ column.Action.ActionHandler(column) }}" target="_blank">
            <mat-icon>{{column.SetIcon(item)}}</mat-icon>
          </a>
        </div>

        <!--Toggle data value on and off and set pipes, if available-->
        <!--column.pipe value comes from columnDefinition-->
        <span *ngIf="column.ShowValue">{{ item[column.ColType] | dataGridPipes: column.Pipe }}</span>
      </span>

    </mat-cell>
  </ng-container>

  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
  <mat-row *matRowDef="let row;
                       let odd = odd;
                       let even = even;
                       columns: displayedColumns;"
                       [ngClass]= "{ 'gray': even, 'light-gray': odd }"
                       (click)="selection.toggle(row)"></mat-row>

</mat-table>
<mat-paginator
  #paginator
  *ngIf="Config?.Features?.Paginator"
  [pageSize]="Config?.Features?.Paginator.PageSize"
  [pageSizeOptions]="Config?.Features?.Paginator.PageSizeOptions"
  showFirstLastButtons>
</mat-paginator>

